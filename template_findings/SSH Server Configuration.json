[{"id": 833, "title": "SSH Server Configuration", "damage": null, "reproducability": null, "exploitability": null, "affected_users": null, "discoverability": null, "dread_total": 0, "effort": "Quick", "type": "System Security", "overview": "<paragraph>Ensure permissions on /etc/ssh/sshd_config are configured securely (not world-readable, writable, or executable). The /etc/ssh/sshd_config file contains configuration specifications for sshd. The /etc/ssh/sshd_config file needs to be protected from unauthorised changes by non-privileged users but needs to be readable as this information is used with many non-privileged programs.</paragraph><paragraph></paragraph><paragraph>Ensure settings below correctly defined:</paragraph><paragraph>- Ensure SSH Protocol is set to 2</paragraph><paragraph>- Ensure SSH LogLevel is set to INFO</paragraph><paragraph>- Ensure SSH X11 forwarding is disabled</paragraph><paragraph>- Ensure SSH MaxAuthTries is set to 4 or less</paragraph><paragraph>- Ensure SSH root login is disabled</paragraph><paragraph>- Ensure SSH PermitEmptyPasswords is disabled</paragraph><paragraph>- Ensure SSH PermitUserEnvironment is disabled</paragraph><paragraph>- Ensure only approved cyphers are used</paragraph><paragraph>- Ensure only approved MAC algorithms are used</paragraph><paragraph>- Ensure SSH Idle Timeout Interval is configured</paragraph><paragraph>- Ensure SSH LoginGraceTime is set to one minute or less</paragraph><paragraph>- Ensure SSH warning banner is configured</paragraph>", "poc": "<paragraph></paragraph>", "remediation": "<paragraph>Run the following commands to set ownership and permissions on /etc/ssh/sshd_config:</paragraph><paragraph></paragraph><paragraph># chown root:root /etc/ssh/sshd_config</paragraph><paragraph># chmod og-rwx /etc/ssh/sshd_config</paragraph><paragraph></paragraph><paragraph>Recommendations for other parameters above. Edit the /etc/ssh/sshd_config file to set the parameter as follows:</paragraph><paragraph></paragraph><paragraph>Protocol 2</paragraph><paragraph>LogLevel INFO</paragraph><paragraph>X11Forwarding no</paragraph><paragraph>MaxAuthTries 4</paragraph><paragraph>PermitRootLogin no</paragraph><paragraph>PermitEmptyPasswords no</paragraph><paragraph>PermitUserEnvironment no</paragraph><paragraph>Ciphers aes256-ctr,aes192-ctr,aes128-ctr</paragraph><paragraph>MACs hmac-sha2-512-etm@openssh.com,hmac-sha2-256-etm@openssh.com,umac-128-etm@openssh.com,hmac-sha2-512,hmac-sha2-256,umac-128@openssh.com</paragraph><paragraph>ClientAliveInterval 300</paragraph><paragraph>ClientAliveCountMax 0</paragraph><paragraph>LoginGraceTime 60</paragraph><paragraph>Banner /etc/issue.net</paragraph>", "references": "<paragraph></paragraph>", "approved": true, "risk": 2, "affected_hosts": null, "av": null, "ac": null, "au": null, "c": null, "i": null, "a": null, "e": null, "rl": null, "rc": null, "cdp": null, "td": null, "cr": null, "ir": null, "ar": null, "cvss_base": 8.3, "cvss_impact": 10.0, "cvss_exploitability": 2.5, "cvss_temporal": 2.6, "cvss_environmental": 0.0, "cvss_modified_impact": 10.0, "cvss_total": 0.0, "ease": null, "c2_vs": "CVSS:2.0/AC:L/AU:M/AV:N/C:C/I:C/I:C/E:H/RL:U/RC:C/TD:H/CR:M/IR:M/AR:M", "attack_vector": "Local", "attack_complexity": "Low", "privileges_required": "None", "user_interaction": "None", "scope_cvss": "Unchanged", "confidentiality": "None", "integrity": "None", "availability": "None", "exploit_maturity": "Not Defined", "remeditation_level": "Not Defined", "report_confidence": "Not Defined", "confidentiality_requirement": "Not Defined", "integrity_requirement": "Not Defined", "availability_requirement": "Not Defined", "mod_attack_vector": "Not Defined", "mod_attack_complexity": "Not Defined", "mod_privileges_required": "Not Defined", "mod_user_interaction": "Not Defined", "mod_scope": "Not Defined", "mod_confidentiality": "Not Defined", "mod_integrity": "Not Defined", "mod_availability": "Not Defined", "cvss_base_score": 2.6, "cvss_impact_score": 0.0, "cvss_mod_impact_score": 0.0, "c3_vs": "CVSS3.0:/AV:L/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:N/E:X/RL:X/RC:X/CR:X/IR:X/AR:X/MAV:X/MAC:X/MPR:X/MUI:X/MS:X/MC:X/MI:X/MA:X", "severity": null, "likelihood": null, "severity_rationale": null, "likelihood_rationale": null, "nist_impact": null, "nist_likelihood": null, "nist800_total": 0.0, "impact_val": null, "likelihood_val": null, "nist_rating": null, "language": null}]